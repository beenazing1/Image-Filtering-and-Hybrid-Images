<html>
<head>
<title>Computer Vision Project</title>
<link href='http://fonts.googleapis.com/css?family=Nunito:300|Crimson+Text|Droid+Sans+Mono' rel='stylesheet' type='text/css'>
<link rel="stylesheet" title="Default" href="styles/github.css">
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>

<link rel="stylesheet" href="highlighting/styles/default.css">
<script src="highlighting/highlight.pack.js"></script>

<style type="text/css">
body {
	margin: 0px;
	width: 100%;
	font-family: 'Crimson Text', serif;
	font-size: 20px;
	background: #fcfcfc;
}
h1 {
	font-family: 'Nunito', sans-serif;
	font-weight: normal;
	font-size: 28px;
	margin: 25px 0px 0px 0px;
}

h2 {
	font-family: 'Nunito', sans-serif;
	font-weight: normal;
	font-size: 32px;
	margin: 15px 0px 35px 0px;
	color: #333;
	word-spacing: 3px;
}

h3 {
	font-family: 'Nunito', sans-serif;
	font-weight: normal;
	font-size: 26px;
	margin: 10px 0px 10px 0px;
	color: #333;
	word-spacing: 2px;
}
h4 {
	font-family: 'Nunito', sans-serif;
	font-weight: normal;
	font-size: 22px;
	margin: 10px 0px 10px 0px;
	color: #333;
	word-spacing: 2px;
}

h5 {
	font-family: 'Nunito', sans-serif;
	font-weight: normal;
	font-size: 18px;
	margin: 10px 0px 10px 0px;
	color: #111;
	word-spacing: 2px;
}

p, li {
	color: #444;
}

a {
	color: #DE3737;
}

.container {
	margin: 0px auto 0px auto;
	width: 960px;
}

#header {
	background: #333;
	width: 100%;
}

#headersub {
	color: #ccc;
	width: 960px;
	margin: 0px auto 0px auto;
	padding: 20px 0px 20px 0px;
}

.chart {
	width: 480px;
}
.lol {
	font-size: 16px;
	color: #888;
	font-style: italic;
}
.sep {
	height: 1px;
	width: 100%;
	background: #999;
	margin: 20px 0px 20px 0px;
}
.footer{
	font-size: 16px;
}
.latex {
	width: 100%;
}

.latex img {
	display: block;
	margin: 0px auto 0px auto;
}

pre {
	font-family: 'Droid Sans Mono';
	font-size: 14px;
}

td img {
  vertical-align: middle;
}

#contents a {
}
</style>
<script type="text/javascript">
    hljs.initHighlightingOnLoad();
</script>
</head>
<body>
<div id="header" >
<div id="headersub">
<h1><span style="color: #DE3737">Beenapreet Kaur Singh</span></h1>
</div>
</div>
<div class="container">

<h2>Project 1: Image Filtering and Hybrid Images</h2>


<p> Hybrid images are generated by superimposing two images at two different spatial scales: The first image is obtained by
filtering it with a low-pass filter, a gaussian filter in this case, and the second image is obtained by filtering a second image with a high-pass filter. The final hybrid image is composed by adding these two filtered images. The my_imfilter() in the python student code  imitates the filter2D function in the OpenCV library.
</p>



<div style="clear:both">
<h3>How padding effects the image</h3>

<p>I have performed padding so that after filtering the size of the image is not affected - The differences are very subtle in this case but it is interesting to note how padding that reflects the boundary pixels (leftmost) creates a more smoother blurred image as compared to zero padding  that leaves an unecessary dark border around the image (2nd from left). Padding that takes the maximum (3rd from left) pixels from the edges highlights the outliers in the image borders and creates a discontinuity at the border. For the mean padding (4th from left) the discontinuity is less visible, but a halo can be seen along the boundary of the image. Hence for minimum discontinuity in the border and image I've used the "Reflect" padding.</p>


<tr>
<td>
<img src="reflect.jpg" width="24%"/>
<img src="zero.jpg"  width="24%"/>
<img src="maximum.jpg" width="24%"/>
<img src="mean.jpg" width="24%"/>
</td>
</tr>

<h2>Python code for Image Padding</h2>

<pre><code>
pad_w=int((filter.shape[0]-1)/2)
npad = ((pad_w, pad_w), (pad_w, pad_w), (0, 0))

padded_image=np.pad(image,pad_width=npad, mode='reflect')

</code></pre>

<h2>Python Code for Hybrid Image </h2>

<h2>(1) my_imfilter() function</h2>
In this function I have simply looped through all the pixels in my image and performed a scalar dot product of each subset of the image array the filter array passes on. The resultant filtered image  - is saved in the filtered_image array <p>

<pre><code>
  for c in range(image.shape[2]):
      for i in range(image.shape[0]):
          for j in range(image.shape[1]):
              filtered_image[i,j,c]=np.sum(np.multiply(padded_image[i:i+filter_size,j:j+filter_size,c],filter))

</code></pre>

<h2>(2) create_hybrid_image() function</h2>
To get High Frequency Image, we simply subtract the low frequencies with the original image as shown below. The resultant Hybrid Image is the sum of the 2 low pass and high pass images. Note the resultant summed image is passed through the np.clip function to make sure the pixel values are between 0 and 1. <p>

<pre><code>
 high_frequencies =image2-my_imfilter(image2,filter)
 low_frequencies=my_imfilter(image1,filter)
 hybrid_image=np.clip(low_frequencies+high_frequencies,0,1)

</code></pre>


<h3>Test Results</h3>
In the below filter results,  apart from the high pass and low pass filters, we have the sobel filter which is more of an edge detecting filter. The Laplacian filter is also an edge detection filter which higlights areas in the image of rapid intensity change. The main difference between the sobel and Laplace filter is that the sobel filter measures the gradient, wheras the laplace filter measures the change in gradient. Hence, the laplace filter is more sensitive to noise. <p>

<p>From left to right -> blur_image, high pass image, identity image, large blur image, sobel image, laplacian image</p>

<img src="blur_image.jpg" width="24%"/>
<img src="high_pass_image.jpg"  width="24%"/>
<img src="identity_image.jpg" width="24%"/>
<img src="large_blur_image.jpg" width="24%"/>
<img src="sobel_image.jpg" width="24%"/>
<img src="laplacian_image.jpg" width="24%"/>





<h3>Final Results - 1</h3>

<table border=1>
<tr>
<td>
<p>Cutoff Frequency=4</p>
<img src="freq_4/low_frequencies.jpg" width="24%"/>
<img src="freq_4/high_frequencies.jpg"  width="24%"/>
<img src="freq_4/hybrid_image.jpg" width="24%"/>
<img src="freq_4/hybrid_image_scales.jpg" width="24%"/>
<p>.</p>
</td>
</tr>


<table border=1>
<tr>
<td>
<p>Cutoff Frequency=7</p>
<img src="freq_7/low_frequencies.jpg" width="24%"/>
<img src="freq_7/high_frequencies.jpg"  width="24%"/>
<img src="freq_7/hybrid_image.jpg" width="24%"/>
<img src="freq_7/hybrid_image_scales.jpg" width="24%"/>
<p>.</p>
</td>
</tr>

<table border=1>
<tr>
<td>
<p>Cutoff Frequency=10</p>
<img src="freq_10/low_frequencies.jpg" width="24%"/>
<img src="freq_10/high_frequencies.jpg"  width="24%"/>
<img src="freq_10/hybrid_image.jpg" width="24%"/>
<img src="freq_10/hybrid_image_scales.jpg" width="24%"/>
<p>.</p>
</td>
</tr>

</table>

<div style="clear:both" >
<p>In the above results as we give a higher cutoff frequency, the higher frequency image in the Hybrid Image dominates. In the first set of results with cutoff frequency=4, we can begin seeing the dog in the hybrid image 2nd image in the Image scales, that is within a smaller distance. However for cutoff frequency 10, the dog image begins to appear as one moves much further away and the higher frequency image (the cat) dominates. The best results are obtained with cut off frequency=7 </p>
</div>
</body>



<h3>Final Results - 2</h3>

<table border=1>
<tr>
<td>
<p>Cutoff Frequency=4, Einstein-Low Pass Filter</p>
<img src="freq_4_2_blur_einstein/low_frequencies.jpg" width="24%"/>
<img src="freq_4_2_blur_einstein/high_frequencies.jpg"  width="24%"/>
<img src="freq_4_2_blur_einstein/hybrid_image.jpg" width="24%"/>
<img src="freq_4_2_blur_einstein/hybrid_image_scales.jpg" width="24%"/>
<p>.</p>
</td>
</tr>


<table border=1>
<tr>
<td>
<p>Cutoff Frequency=5, Marilyn-Low Pass Filter</p>
<img src="freq_5_blur_marilyn/low_frequencies.jpg" width="24%"/>
<img src="freq_5_blur_marilyn/high_frequencies.jpg"  width="24%"/>
<img src="freq_5_blur_marilyn/hybrid_image.jpg" width="24%"/>
<img src="freq_5_blur_marilyn/hybrid_image_scales.jpg" width="24%"/>
<p>.</p>
</td>
</tr>

<table border=1>
<tr>
<td>
<p>Cutoff Frequency=7, Marilyn-Low Pass Filter</p>
<img src="freq_7_2/low_frequencies.jpg" width="24%"/>
<img src="freq_7_2/high_frequencies.jpg"  width="24%"/>
<img src="freq_7_2/hybrid_image.jpg" width="24%"/>
<img src="freq_7_2/hybrid_image_scales.jpg" width="24%"/>
<p>.</p>
</td>
</tr>

</table>

<div style="clear:both" >
<p>In this example I have tried blurring both the Marilyn image and the Einstein image however better results are observed when blurring the Marilyn image, as the Einstein image has some sharper features, that stand out even when it is blurred as the image has a darkbackground and more pronounced shadows and hence is harder to morph. Best results are observed with cutoff frequency 5 in this case.  </p>
</div>
</body>
</html>
